#  Foundry 框架



### 1. **Forge**

- **功能定位**：智能合约开发的核心测试和编译工具。

- **主要作用**：

  - **编译**：将 Solidity 合约编译成 EVM 字节码。
  - **测试**：
    - 单元测试（Unit Tests）
    - 属性测试（Property-based / fuzz testing）
    - 断言测试（通过 `assert`, `assertEq` 等断言检查状态）
  - **部署**：
    - 可连接本地或远程网络进行部署
    - 支持脚本化部署（通过 `forge script`）
  - **模拟交易**：测试交易流程、事件发射、余额变动等。

- **示例命令**：

  ```
  forge build       # 编译合约
  forge test        # 执行测试
  forge script MyScript.sol:MyScript --rpc-url ...
  ```

------

### 2. **Cast**

- **功能定位**：轻量级的命令行工具，用于与区块链交互。

- **主要作用**：

  - 查询链上数据（余额、状态变量）
  - 发送交易（ETH 转账、调用合约函数）
  - 调试合约行为（静态调用、回溯事务）
  - 支持脚本化操作，便于自动化流程

- **示例命令**：

  ```
  cast send 0xABC... "transfer(address,uint256)" 0xDEF... 100
  cast call 0xABC... "balanceOf(address)(uint256)" 0xDEF...
  ```

------

### 3. **Anvil**

- **功能定位**：本地 EVM 节点模拟器（类似 Ganache 或 Hardhat Network）。

- **主要作用**：

  - 提供快速的本地测试链
  - 支持即时交易确认
  - 内置调试功能（可查看交易堆栈、日志事件）
  - 便于在本地进行测试、调试和快速迭代

- **示例命令**：

  ```
  anvil           # 启动本地 EVM 节点
  anvil -b 10     # 启动并生成 10 个区块
  ```

------

### 4. **Foundry 的核心特点与优势**

- **高速执行**：Rust 实现的测试框架，比 Hardhat/Truffle 快 10-100 倍。
- **全流程覆盖**：
  - 开发 → 编译 → 测试 → 部署 → 调试
- **高级测试功能**：
  - 支持 fuzz 测试（随机化输入验证智能合约健壮性）
  - 支持 cheatcodes（可以直接修改区块时间、余额等 EVM 状态）
- **CLI 友好**：所有操作均可通过命令行完成，方便 CI/CD 集成。

------

💡 **总结**：

| 组件      | 功能                      | 典型用途                 |
| --------- | ------------------------- | ------------------------ |
| **Forge** | 编译 / 测试 / 部署 / 脚本 | 合约开发核心工具         |
| **Cast**  | 链上交互 / 调试           | 快速发送交易、查询数据   |
| **Anvil** | 本地节点模拟              | 本地测试、调试、快速迭代 |